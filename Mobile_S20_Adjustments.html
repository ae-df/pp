<!--
  MOBILE S20 ADJUSTMENTS
  Ajustes específicos para telas pequenas (Samsung S20: 360x800)
  
  Inclua após o design-system: <?!= include('Mobile_S20_Adjustments'); ?>
  
  ✅ Touch targets 48px+ (WCAG 2.1)
  ✅ Safe areas para punch-hole
  ✅ Alinhamentos padronizados
  ✅ Comportamentos mobile-first
-->

<style>
/* ========================================
   MOBILE S20 ADJUSTMENTS
   Samsung S20: 360x800 CSS pixels
   ======================================== */

/* Reset Mobile Essencial */
@media (max-width: 480px) {
  
  /* Safe Areas */
  :root {
    --safe-top: env(safe-area-inset-top, 24px);
    --safe-bottom: env(safe-area-inset-bottom, 0px);
    --mobile-padding: 16px;
    --mobile-gap: 12px;
    --touch-target: 48px;
  }
  
  /* Body ajustes */
  body {
    padding: var(--mobile-padding) !important;
    padding-top: calc(var(--safe-top) + var(--mobile-padding)) !important;
    font-size: 15px;
    -webkit-text-size-adjust: 100%;
  }
  
  /* Containers */
  .login-container,
  .card,
  .modal-box,
  #app {
    border-radius: 16px !important;
    padding: 20px !important;
    margin: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
  }
  
  /* Headers */
  .login-header,
  .header,
  .modal-header {
    padding: 20px 16px !important;
    margin: -20px -20px 20px -20px !important;
    border-radius: 16px 16px 0 0 !important;
  }
  
  .login-header h1,
  .header h1 {
    font-size: 22px !important;
  }
  
  /* Formulários - Touch Friendly */
  input,
  select,
  textarea,
  .form-input,
  .form-select,
  .form-textarea,
  .field input,
  .field select,
  .field textarea {
    min-height: var(--touch-target) !important;
    font-size: 16px !important; /* Previne zoom iOS */
    padding: 12px 16px !important;
    border-radius: 12px !important;
    border-width: 2px !important;
  }
  
  /* Labels */
  label,
  .form-label,
  .field label {
    font-size: 14px !important;
    font-weight: 500 !important;
    margin-bottom: 8px !important;
    display: block !important;
  }
  
  /* Botões - Touch Targets */
  button,
  .btn,
  [role="button"],
  input[type="submit"],
  input[type="button"],
  .btn-submit,
  .btn-primary,
  .btn-secondary {
    min-height: var(--touch-target) !important;
    padding: 14px 20px !important;
    font-size: 15px !important;
    font-weight: 600 !important;
    border-radius: 12px !important;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
  }
  
  .btn-block,
  .btn-submit {
    width: 100% !important;
  }
  
  /* Espaçamento entre botões */
  .btn + .btn,
  button + button {
    margin-top: 12px !important;
  }
  
  /* Tabs */
  .tabs {
    gap: 0 !important;
    margin-bottom: 20px !important;
  }
  
  .tab {
    flex: 1 !important;
    min-height: var(--touch-target) !important;
    font-size: 14px !important;
    padding: 12px 8px !important;
    text-align: center !important;
  }
  
  /* Cards de Seleção de Usuário */
  .user-type-cards {
    gap: var(--mobile-gap) !important;
  }
  
  .user-card {
    padding: 16px !important;
    border-radius: 14px !important;
  }
  
  .user-card .card-icon {
    font-size: 28px !important;
    margin-bottom: 8px !important;
  }
  
  .user-card .card-title {
    font-size: 15px !important;
  }
  
  .user-card .card-description {
    font-size: 12px !important;
    margin-bottom: 8px !important;
  }
  
  .user-card .card-features {
    font-size: 11px !important;
    line-height: 1.5 !important;
  }
  
  /* Form Groups */
  .form-group,
  .field {
    margin-bottom: 16px !important;
  }
  
  /* Grids responsivos */
  .quick-actions,
  .grid-cols-2,
  .grid-cols-3,
  .grid-cols-4 {
    grid-template-columns: 1fr 1fr !important;
    gap: var(--mobile-gap) !important;
  }
  
  .field-row {
    grid-template-columns: 1fr !important;
    gap: var(--mobile-gap) !important;
  }
  
  /* Action Cards */
  .action-card {
    padding: 16px !important;
    border-radius: 14px !important;
  }
  
  .action-card .icon {
    font-size: 32px !important;
    margin-bottom: 8px !important;
  }
  
  .action-card h3 {
    font-size: 14px !important;
    line-height: 1.3 !important;
  }
  
  .action-card p {
    font-size: 11px !important;
    display: none; /* Oculta descrição em telas pequenas */
  }
  
  .action-card .badge {
    top: 8px !important;
    right: 8px !important;
    padding: 3px 8px !important;
    font-size: 11px !important;
  }
  
  /* Status Bar */
  .status-bar {
    gap: var(--mobile-gap) !important;
    margin-bottom: 20px !important;
  }
  
  .status-item {
    min-width: calc(50% - 6px) !important;
    padding: 14px 12px !important;
    border-radius: 12px !important;
    flex-direction: column !important;
    text-align: center !important;
    gap: 4px !important;
  }
  
  .status-item .num {
    font-size: 24px !important;
  }
  
  .status-item .label {
    font-size: 11px !important;
  }
  
  /* Lista Inteligente */
  .smart-list {
    border-radius: 14px !important;
  }
  
  .list-header {
    padding: 16px !important;
    flex-direction: column !important;
    align-items: flex-start !important;
    gap: 12px !important;
  }
  
  .list-header h2 {
    font-size: 15px !important;
  }
  
  .filters {
    width: 100% !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch;
    padding-bottom: 4px !important;
  }
  
  .filter-btn {
    min-height: 36px !important;
    padding: 8px 14px !important;
    font-size: 12px !important;
    white-space: nowrap !important;
  }
  
  .list-item {
    padding: 14px 16px !important;
    gap: 12px !important;
  }
  
  .item-icon {
    width: 40px !important;
    height: 40px !important;
    font-size: 18px !important;
    border-radius: 10px !important;
  }
  
  .item-info h4 {
    font-size: 14px !important;
  }
  
  .item-info p {
    font-size: 11px !important;
  }
  
  .item-action {
    padding: 8px 12px !important;
    font-size: 12px !important;
    border-radius: 8px !important;
  }
  
  /* Quick Select */
  .quick-select {
    gap: var(--mobile-gap) !important;
  }
  
  .quick-option {
    padding: 14px 12px !important;
    border-radius: 12px !important;
  }
  
  .quick-option .opt-icon {
    font-size: 22px !important;
  }
  
  .quick-option .opt-label {
    font-size: 12px !important;
  }
  
  /* Modal */
  .modal-overlay {
    padding: var(--mobile-padding) !important;
    align-items: flex-end !important; /* Bottom sheet style */
  }
  
  .modal-box {
    border-radius: 20px 20px 0 0 !important;
    max-height: 90vh !important;
    margin-bottom: 0 !important;
  }
  
  .modal-header {
    padding: 16px 20px !important;
  }
  
  .modal-header h2,
  #modalTitle {
    font-size: 17px !important;
  }
  
  .close-btn {
    width: 36px !important;
    height: 36px !important;
    min-height: 36px !important;
    padding: 0 !important;
  }
  
  .modal-body {
    padding: 20px !important;
    max-height: calc(90vh - 70px) !important;
  }
  
  /* Alerts */
  .alert {
    padding: 14px 16px !important;
    font-size: 13px !important;
    border-radius: 12px !important;
  }
  
  /* Toast */
  .toast {
    left: var(--mobile-padding) !important;
    right: var(--mobile-padding) !important;
    bottom: calc(var(--safe-bottom) + 20px) !important;
    transform: none !important;
    border-radius: 12px !important;
    padding: 14px 16px !important;
    font-size: 14px !important;
  }
  
  /* Empty State */
  .empty-state {
    padding: 40px 20px !important;
  }
  
  .empty-state .icon {
    font-size: 48px !important;
  }
  
  .empty-state h3 {
    font-size: 16px !important;
  }
  
  .empty-state p {
    font-size: 13px !important;
  }
  
  /* Loading */
  .loading {
    padding: 30px !important;
  }
  
  .spinner {
    width: 36px !important;
    height: 36px !important;
  }
  
  /* Badges */
  .badge,
  .user-type-badge {
    padding: 4px 10px !important;
    font-size: 11px !important;
  }
  
  /* Tables - Scroll horizontal */
  .table-container {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch;
    margin: 0 -20px !important;
    padding: 0 20px !important;
  }
  
  table {
    min-width: 500px !important;
  }
  
  th, td {
    padding: 10px 12px !important;
    font-size: 13px !important;
  }
  
  /* Scrollbar sutil */
  ::-webkit-scrollbar {
    width: 4px !important;
    height: 4px !important;
  }
  
  ::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.15) !important;
    border-radius: 4px !important;
  }
}

/* ========================================
   AJUSTES ESPECÍFICOS PARA 360px (S20)
   ======================================== */
@media (max-width: 380px) {
  
  :root {
    --mobile-padding: 12px;
    --mobile-gap: 10px;
  }
  
  body {
    padding: var(--mobile-padding) !important;
  }
  
  .login-container,
  .card,
  #app {
    padding: 16px !important;
  }
  
  .login-header,
  .header {
    padding: 16px 12px !important;
    margin: -16px -16px 16px -16px !important;
  }
  
  .login-header h1 {
    font-size: 20px !important;
  }
  
  .user-card {
    padding: 14px !important;
  }
  
  .user-card .card-features {
    display: none; /* Oculta features em telas muito pequenas */
  }
  
  .action-card {
    padding: 14px !important;
  }
  
  .action-card .icon {
    font-size: 28px !important;
  }
  
  .action-card h3 {
    font-size: 13px !important;
  }
  
  .status-item .num {
    font-size: 22px !important;
  }
  
  .status-item .label {
    font-size: 10px !important;
  }
  
  .modal-body {
    padding: 16px !important;
  }
}

/* ========================================
   COMPORTAMENTOS TOUCH
   ======================================== */
@media (hover: none) and (pointer: coarse) {
  
  /* Remove hover effects em touch */
  .btn:hover,
  .card:hover,
  .action-card:hover,
  .user-card:hover,
  .list-item:hover {
    transform: none !important;
  }
  
  /* Active states para feedback tátil */
  .btn:active,
  .action-card:active,
  .user-card:active,
  .list-item:active,
  .quick-option:active {
    transform: scale(0.97) !important;
    opacity: 0.9 !important;
  }
  
  /* Previne seleção de texto em elementos interativos */
  button,
  .btn,
  .action-card,
  .user-card,
  .list-item,
  .quick-option,
  .tab,
  .filter-btn {
    -webkit-user-select: none;
    user-select: none;
  }
}

/* ========================================
   ORIENTAÇÃO LANDSCAPE (HORIZONTAL)
   ======================================== */
@media (max-height: 500px) and (orientation: landscape) {
  
  .modal-overlay {
    align-items: center !important;
  }
  
  .modal-box {
    border-radius: 16px !important;
    max-height: 95vh !important;
  }
  
  .modal-body {
    max-height: calc(95vh - 60px) !important;
  }
  
  .login-container {
    max-width: 500px !important;
    margin: 0 auto !important;
  }
}

/* ========================================
   ACESSIBILIDADE
   ======================================== */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Focus visible para navegação por teclado */
:focus-visible {
  outline: 3px solid var(--primary, #667eea) !important;
  outline-offset: 2px !important;
}

/* Skip link */
.skip-link {
  position: absolute;
  top: -40px;
  left: 0;
  background: var(--primary, #667eea);
  color: white;
  padding: 8px 16px;
  z-index: 9999;
  border-radius: 0 0 8px 0;
}

.skip-link:focus {
  top: 0;
}
</style>

<script>
/**
 * Mobile S20 Adjustments - JavaScript Helpers
 */
(function() {
  'use strict';
  
  // Detecta se é dispositivo móvel
  const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
  const isSmallScreen = window.innerWidth <= 480;
  
  if (isMobile || isSmallScreen) {
    document.documentElement.classList.add('mobile-device');
    
    // Previne zoom em double-tap
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function(e) {
      const now = Date.now();
      if (now - lastTouchEnd <= 300) {
        e.preventDefault();
      }
      lastTouchEnd = now;
    }, { passive: false });
    
    // Ajusta viewport height para mobile browsers
    function setVH() {
      const vh = window.innerHeight * 0.01;
      document.documentElement.style.setProperty('--vh', `${vh}px`);
    }
    setVH();
    window.addEventListener('resize', setVH);
    
    // Haptic feedback helper
    window.hapticFeedback = function(type) {
      if ('vibrate' in navigator) {
        const patterns = {
          light: [10],
          medium: [20],
          heavy: [30],
          success: [10, 50, 10],
          error: [50, 30, 50]
        };
        navigator.vibrate(patterns[type] || patterns.light);
      }
    };
    
    // Adiciona feedback tátil aos botões
    document.addEventListener('click', function(e) {
      const target = e.target.closest('button, .btn, .action-card, .user-card, .quick-option');
      if (target) {
        hapticFeedback('light');
      }
    });
  }
  
  // Fecha modais ao clicar fora
  document.addEventListener('click', function(e) {
    if (e.target.classList.contains('modal-overlay') && e.target.classList.contains('active')) {
      const closeBtn = e.target.querySelector('.close-btn, [onclick*="fecharModal"]');
      if (closeBtn) closeBtn.click();
    }
  });
  
  // Fecha modais com ESC
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      const modal = document.querySelector('.modal-overlay.active');
      if (modal) {
        const closeBtn = modal.querySelector('.close-btn, [onclick*="fecharModal"]');
        if (closeBtn) closeBtn.click();
      }
    }
  });
  
})();
</script>
